<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Image Resizer — SkyBlue Tools</title>
  <style>
    :root{
      --sky: #62c3ff; /* skyblue */
      --sky-2: #e8f8ff;
      --white: #ffffff;
      --text: #0f1724;
      --muted: #54606a;
      --card-radius: 14px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: linear-gradient(180deg,var(--sky-2),var(--white));
      color:var(--text);
      padding:24px;
      -webkit-font-smoothing:antialiased;
    }
    .app{
      max-width:980px;
      margin:0 auto;
      background:var(--white);
      border-radius:18px;
      box-shadow:0 8px 30px rgba(17,24,39,.08);
      overflow:hidden;
    }
    header{
      padding:20px 24px;
      display:flex;gap:12px;align-items:center;background:linear-gradient(90deg,var(--sky),#7ed6ff);
      color:white
    }
    header h1{font-size:18px;margin:0}
    .content{display:flex;gap:24px;padding:20px;flex-wrap:wrap}
    .panel{flex:1 1 320px;background:linear-gradient(180deg,var(--white),#fbfeff);padding:18px;border-radius:12px}
    .uploader{border:2px dashed rgba(98,195,255,.45);padding:18px;border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;text-align:center}
    .uploader.dragover{background:var(--sky-2)}
    .btn{background:var(--sky);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    .controls{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}

    label{font-size:13px;color:var(--muted)}
    input[type="number"], select, input[type="file"]{width:100%;padding:8px;border-radius:8px;border:1px solid #e6eef6}
    .row{display:flex;gap:10px}
    .preview{display:flex;flex-direction:column;align-items:center;gap:12px}
    canvas{max-width:100%;border-radius:8px;background:#f6fbff}
    .meta{font-size:13px;color:var(--muted)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .small{padding:8px 10px;font-size:13px}
    footer{padding:12px 20px;background:linear-gradient(180deg,#f7fdff,#ffffff);font-size:13px;color:var(--muted);border-top:1px solid #f0f7fb}
    @media (max-width:640px){
      .content{padding:12px}
      header{padding:14px}
      .controls{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="24" height="24" rx="6" fill="white"/>
        <path d="M7 13l3-3 2 2 5-5" stroke="#62c3ff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div>
        <h1>Image Resizer — SkyBlue Tools</h1>
        <div style="font-size:12px;opacity:.9">Upload, set width/height, preview & download — responsive and fast.</div>
      </div>
    </header>

    <div class="content">
      <section class="panel">
        <div class="uploader" id="dropzone">
          <div style="max-width:260px">
            <p style="margin:0;font-weight:600">Drop image here or click to upload</p>
            <p class="meta">Supports PNG, JPEG. Up to browser limits.</p>
          </div>
          <input id="fileInput" type="file" accept="image/*" style="display:none" />
          <button class="btn" id="chooseBtn">Choose Image</button>
        </div>

        <div style="margin-top:14px">
          <div class="controls">
            <div>
              <label>Width (px)</label>
              <input id="widthInput" type="number" min="1" placeholder="Width" />
            </div>
            <div>
              <label>Height (px)</label>
              <input id="heightInput" type="number" min="1" placeholder="Height" />
            </div>
          </div>

          <div class="row" style="margin-top:10px;align-items:center">
            <label style="display:flex;align-items:center;gap:8px"><input id="keepAspect" type="checkbox" checked /> Keep aspect ratio</label>
            <div style="flex:1"></div>
            <label style="font-size:13px;color:var(--muted)">Format</label>
            <select id="formatSelect" style="width:120px">
              <option value="image/png">PNG</option>
              <option value="image/jpeg">JPEG</option>
            </select>
          </div>

          <div class="row" style="margin-top:10px;align-items:center">
            <label style="display:flex;align-items:center;gap:8px">
              Quality (for JPEG)
            </label>
            <input id="qualityRange" type="range" min="0.1" max="1" step="0.05" value="0.92" style="flex:1" />
          </div>

          <div class="actions">
            <button class="btn small" id="resizeBtn">Resize & Preview</button>
            <button class="small" id="downloadBtn" disabled>Download</button>
            <button class="small" id="resetBtn">Reset</button>
          </div>
        </div>
      </section>

      <aside class="panel preview">
        <div style="width:100%;display:flex;justify-content:space-between;align-items:center">
          <div>
            <strong>Preview</strong>
            <div class="meta" id="imageInfo">No image loaded</div>
          </div>
          <div class="meta">Tip: Use "Keep aspect ratio" to avoid distortion</div>
        </div>

        <canvas id="canvas" width="600" height="400" style="margin-top:12px;max-height:60vh"></canvas>
      </aside>
    </div>

    <footer>
      Drag & drop supported. The tool runs fully in your browser — no uploads to server.
    </footer>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const chooseBtn = document.getElementById('chooseBtn');
    const dropzone = document.getElementById('dropzone');
    const keepAspect = document.getElementById('keepAspect');
    const widthInput = document.getElementById('widthInput');
    const heightInput = document.getElementById('heightInput');
    const formatSelect = document.getElementById('formatSelect');
    const qualityRange = document.getElementById('qualityRange');
    const resizeBtn = document.getElementById('resizeBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const resetBtn = document.getElementById('resetBtn');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const imageInfo = document.getElementById('imageInfo');

    let originalImage = new Image();
    let originalWidth = 0, originalHeight = 0;
    let currentBlobURL = null;

    function reset(){
      fileInput.value = '';
      originalImage = new Image();
      originalWidth = originalHeight = 0;
      widthInput.value = '';
      heightInput.value = '';
      imageInfo.textContent = 'No image loaded';
      ctx.clearRect(0,0,canvas.width,canvas.height);
      downloadBtn.disabled = true;
      if(currentBlobURL){ URL.revokeObjectURL(currentBlobURL); currentBlobURL = null; }
    }

    chooseBtn.addEventListener('click', ()=> fileInput.click());
    dropzone.addEventListener('click', ()=> fileInput.click());

    // Drag and drop
    ['dragenter','dragover'].forEach(ev => {
      dropzone.addEventListener(ev, e=>{ e.preventDefault(); e.stopPropagation(); dropzone.classList.add('dragover'); });
    });
    ['dragleave','drop'].forEach(ev=>{
      dropzone.addEventListener(ev, e=>{ e.preventDefault(); e.stopPropagation(); dropzone.classList.remove('dragover'); });
    });
    dropzone.addEventListener('drop', e=>{
      const f = e.dataTransfer.files[0];
      if(f) handleFile(f);
    });

    fileInput.addEventListener('change', ()=>{
      const f = fileInput.files[0];
      if(f) handleFile(f);
    });

    function handleFile(file){
      if(!file.type.startsWith('image/')){ alert('Please select an image file'); return; }
      const reader = new FileReader();
      reader.onload = () => {
        originalImage = new Image();
        originalImage.onload = () => {
          originalWidth = originalImage.naturalWidth;
          originalHeight = originalImage.naturalHeight;
          widthInput.value = originalWidth;
          heightInput.value = originalHeight;
          imageInfo.textContent = `Original: ${originalWidth} × ${originalHeight} — ${Math.round(file.size/1024)} KB`;
          // draw original to canvas
          fitCanvas(originalWidth, originalHeight);
          ctx.clearRect(0,0,canvas.width,canvas.height);
          drawToCanvas(originalImage, originalWidth, originalHeight);
        };
        originalImage.src = reader.result;
      };
      reader.readAsDataURL(file);
    }

    function fitCanvas(w,h){
      // keep canvas size reasonable for preview but maintain aspect
      const maxPreview = 1000;
      let cw = w, ch = h;
      if(w > maxPreview || h > maxPreview){
        const ratio = Math.min(maxPreview/w, maxPreview/h);
        cw = Math.round(w*ratio);
        ch = Math.round(h*ratio);
      }
      canvas.width = cw;
      canvas.height = ch;
    }

    function drawToCanvas(img, w, h){
      // draw scaled for preview using canvas sized earlier
      const previewRatio = canvas.width / w;
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = 'high';
      ctx.drawImage(img, 0, 0, w * previewRatio, h * previewRatio);
    }

    // aspect helpers
    widthInput.addEventListener('input', ()=>{
      if(!originalWidth) return;
      const newW = parseInt(widthInput.value) || 0;
      if(keepAspect.checked){
        const newH = Math.round((newW * originalHeight) / originalWidth) || '';
        heightInput.value = newH;
      }
    });
    heightInput.addEventListener('input', ()=>{
      if(!originalHeight) return;
      const newH = parseInt(heightInput.value) || 0;
      if(keepAspect.checked){
        const newW = Math.round((newH * originalWidth) / originalHeight) || '';
        widthInput.value = newW;
      }
    });

    resizeBtn.addEventListener('click', async ()=>{
      if(!originalWidth || !originalHeight){ alert('Please upload an image first'); return; }
      const targetW = parseInt(widthInput.value);
      const targetH = parseInt(heightInput.value);
      if(!targetW || !targetH){ alert('Please enter valid width and height'); return; }

      // create an offscreen canvas to create final image at exact pixel size
      const off = document.createElement('canvas');
      off.width = targetW;
      off.height = targetH;
      const offCtx = off.getContext('2d');
      offCtx.imageSmoothingEnabled = true;
      offCtx.imageSmoothingQuality = 'high';
      // draw original image scaled to target size
      offCtx.clearRect(0,0,off.width,off.height);
      offCtx.drawImage(originalImage, 0, 0, targetW, targetH);

      // For preview, fit canvas to a reasonable display size and show the resized image
      fitCanvas(targetW,targetH);
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // draw the off canvas scaled down for preview
      ctx.drawImage(off, 0, 0, canvas.width, canvas.height);

      // prepare blob for download
      const mime = formatSelect.value || 'image/png';
      const quality = parseFloat(qualityRange.value) || 0.92;
      off.toBlob(blob => {
        if(currentBlobURL){ URL.revokeObjectURL(currentBlobURL); }
        currentBlobURL = URL.createObjectURL(blob);
        downloadBtn.disabled = false;
        downloadBtn.onclick = () => {
          const a = document.createElement('a');
          const ext = mime === 'image/png' ? 'png' : 'jpg';
          a.href = currentBlobURL;
          a.download = `resized-${targetW}x${targetH}.${ext}`;
          document.body.appendChild(a);
          a.click();
          a.remove();
        };
      }, mime, mime === 'image/jpeg' ? quality : undefined);

    });

    resetBtn.addEventListener('click', reset);

    // initialize
    reset();
  </script>
</body>
</html>
